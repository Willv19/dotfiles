#!/bin/sh
BOOKMARKS=~/.bookmarks

URL=$(xprop -id $(xprop -root 32x '\t$0' _NET_ACTIVE_WINDOW | cut -f 2) _NET_WM_NAME | egrep -o "http\S*" || rofi -dmenu -lines 0 -p "url" | egrep -o "http\S*")
if ! [ -n "$URL" ]; then
	dunstify -C 27
	exit 0
fi
dunstify -r 27 "URL to grab" "$URL"
NAME=$(rofi -dmenu -lines 0 -p "name")
if ! [ -n "$NAME" ]; then
	dunstify -C 27
elif awk -F "\t" '{print $1}' $BOOKMARKS | egrep "^$NAME$"; then
	dunstify -r 27 -u critical "Bookmark" "Already exists"
else
	echo "$NAME	$URL" >> $BOOKMARKS
	dunstify -r 27 -u low "Bookmark" "$NAME: $URL"
fi
